"use strict";var Ue=Object.create;var R=Object.defineProperty;var ze=Object.getOwnPropertyDescriptor;var je=Object.getOwnPropertyNames;var Ge=Object.getPrototypeOf,qe=Object.prototype.hasOwnProperty;var l=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),He=(t,e)=>{for(var n in e)R(t,n,{get:e[n],enumerable:!0})},V=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of je(e))!qe.call(t,i)&&i!==n&&R(t,i,{get:()=>e[i],enumerable:!(o=ze(e,i))||o.enumerable});return t};var E=(t,e,n)=>(n=t!=null?Ue(Ge(t)):{},V(e||!t||!t.__esModule?R(n,"default",{value:t,enumerable:!0}):n,t)),Xe=t=>V(R({},"__esModule",{value:!0}),t);var M=l((An,ne)=>{var Ze=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};ne.exports=Ze});var U=l((bn,oe)=>{var Ke="2.0.0",et=Number.MAX_SAFE_INTEGER||9007199254740991,tt=16,nt=256-6,ot=["major","premajor","minor","preminor","patch","prepatch","prerelease"];oe.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:tt,MAX_SAFE_BUILD_LENGTH:nt,MAX_SAFE_INTEGER:et,RELEASE_TYPES:ot,SEMVER_SPEC_VERSION:Ke,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var se=l((f,re)=>{var{MAX_SAFE_COMPONENT_LENGTH:z,MAX_SAFE_BUILD_LENGTH:rt,MAX_LENGTH:st}=U(),it=M();f=re.exports={};var at=f.re=[],ct=f.safeRe=[],r=f.src=[],s=f.t={},lt=0,j="[a-zA-Z0-9-]",pt=[["\\s",1],["\\d",st],[j,rt]],dt=t=>{for(let[e,n]of pt)t=t.split(`${e}*`).join(`${e}{0,${n}}`).split(`${e}+`).join(`${e}{1,${n}}`);return t},a=(t,e,n)=>{let o=dt(e),i=lt++;it(t,i,e),s[t]=i,r[i]=e,at[i]=new RegExp(e,n?"g":void 0),ct[i]=new RegExp(o,n?"g":void 0)};a("NUMERICIDENTIFIER","0|[1-9]\\d*");a("NUMERICIDENTIFIERLOOSE","\\d+");a("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${j}*`);a("MAINVERSION",`(${r[s.NUMERICIDENTIFIER]})\\.(${r[s.NUMERICIDENTIFIER]})\\.(${r[s.NUMERICIDENTIFIER]})`);a("MAINVERSIONLOOSE",`(${r[s.NUMERICIDENTIFIERLOOSE]})\\.(${r[s.NUMERICIDENTIFIERLOOSE]})\\.(${r[s.NUMERICIDENTIFIERLOOSE]})`);a("PRERELEASEIDENTIFIER",`(?:${r[s.NUMERICIDENTIFIER]}|${r[s.NONNUMERICIDENTIFIER]})`);a("PRERELEASEIDENTIFIERLOOSE",`(?:${r[s.NUMERICIDENTIFIERLOOSE]}|${r[s.NONNUMERICIDENTIFIER]})`);a("PRERELEASE",`(?:-(${r[s.PRERELEASEIDENTIFIER]}(?:\\.${r[s.PRERELEASEIDENTIFIER]})*))`);a("PRERELEASELOOSE",`(?:-?(${r[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${r[s.PRERELEASEIDENTIFIERLOOSE]})*))`);a("BUILDIDENTIFIER",`${j}+`);a("BUILD",`(?:\\+(${r[s.BUILDIDENTIFIER]}(?:\\.${r[s.BUILDIDENTIFIER]})*))`);a("FULLPLAIN",`v?${r[s.MAINVERSION]}${r[s.PRERELEASE]}?${r[s.BUILD]}?`);a("FULL",`^${r[s.FULLPLAIN]}$`);a("LOOSEPLAIN",`[v=\\s]*${r[s.MAINVERSIONLOOSE]}${r[s.PRERELEASELOOSE]}?${r[s.BUILD]}?`);a("LOOSE",`^${r[s.LOOSEPLAIN]}$`);a("GTLT","((?:<|>)?=?)");a("XRANGEIDENTIFIERLOOSE",`${r[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);a("XRANGEIDENTIFIER",`${r[s.NUMERICIDENTIFIER]}|x|X|\\*`);a("XRANGEPLAIN",`[v=\\s]*(${r[s.XRANGEIDENTIFIER]})(?:\\.(${r[s.XRANGEIDENTIFIER]})(?:\\.(${r[s.XRANGEIDENTIFIER]})(?:${r[s.PRERELEASE]})?${r[s.BUILD]}?)?)?`);a("XRANGEPLAINLOOSE",`[v=\\s]*(${r[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[s.XRANGEIDENTIFIERLOOSE]})(?:${r[s.PRERELEASELOOSE]})?${r[s.BUILD]}?)?)?`);a("XRANGE",`^${r[s.GTLT]}\\s*${r[s.XRANGEPLAIN]}$`);a("XRANGELOOSE",`^${r[s.GTLT]}\\s*${r[s.XRANGEPLAINLOOSE]}$`);a("COERCE",`(^|[^\\d])(\\d{1,${z}})(?:\\.(\\d{1,${z}}))?(?:\\.(\\d{1,${z}}))?(?:$|[^\\d])`);a("COERCERTL",r[s.COERCE],!0);a("LONETILDE","(?:~>?)");a("TILDETRIM",`(\\s*)${r[s.LONETILDE]}\\s+`,!0);f.tildeTrimReplace="$1~";a("TILDE",`^${r[s.LONETILDE]}${r[s.XRANGEPLAIN]}$`);a("TILDELOOSE",`^${r[s.LONETILDE]}${r[s.XRANGEPLAINLOOSE]}$`);a("LONECARET","(?:\\^)");a("CARETTRIM",`(\\s*)${r[s.LONECARET]}\\s+`,!0);f.caretTrimReplace="$1^";a("CARET",`^${r[s.LONECARET]}${r[s.XRANGEPLAIN]}$`);a("CARETLOOSE",`^${r[s.LONECARET]}${r[s.XRANGEPLAINLOOSE]}$`);a("COMPARATORLOOSE",`^${r[s.GTLT]}\\s*(${r[s.LOOSEPLAIN]})$|^$`);a("COMPARATOR",`^${r[s.GTLT]}\\s*(${r[s.FULLPLAIN]})$|^$`);a("COMPARATORTRIM",`(\\s*)${r[s.GTLT]}\\s*(${r[s.LOOSEPLAIN]}|${r[s.XRANGEPLAIN]})`,!0);f.comparatorTrimReplace="$1$2$3";a("HYPHENRANGE",`^\\s*(${r[s.XRANGEPLAIN]})\\s+-\\s+(${r[s.XRANGEPLAIN]})\\s*$`);a("HYPHENRANGELOOSE",`^\\s*(${r[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${r[s.XRANGEPLAINLOOSE]})\\s*$`);a("STAR","(<|>)?=?\\s*\\*");a("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");a("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var ae=l((Rn,ie)=>{var mt=Object.freeze({loose:!0}),ut=Object.freeze({}),ht=t=>t?typeof t!="object"?mt:t:ut;ie.exports=ht});var de=l((Nn,pe)=>{var ce=/^[0-9]+$/,le=(t,e)=>{let n=ce.test(t),o=ce.test(e);return n&&o&&(t=+t,e=+e),t===e?0:n&&!o?-1:o&&!n?1:t<e?-1:1},ft=(t,e)=>le(e,t);pe.exports={compareIdentifiers:le,rcompareIdentifiers:ft}});var G=l((Sn,fe)=>{var C=M(),{MAX_LENGTH:me,MAX_SAFE_INTEGER:L}=U(),{safeRe:ue,t:he}=se(),Et=ae(),{compareIdentifiers:w}=de(),p=class{constructor(e,n){if(n=Et(n),e instanceof p){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>me)throw new TypeError(`version is longer than ${me} characters`);C("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;let o=e.trim().match(n.loose?ue[he.LOOSE]:ue[he.FULL]);if(!o)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>L||this.major<0)throw new TypeError("Invalid major version");if(this.minor>L||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>L||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let c=+i;if(c>=0&&c<L)return c}return i}):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(C("SemVer.compare",this.version,this.options,e),!(e instanceof p)){if(typeof e=="string"&&e===this.version)return 0;e=new p(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof p||(e=new p(e,this.options)),w(this.major,e.major)||w(this.minor,e.minor)||w(this.patch,e.patch)}comparePre(e){if(e instanceof p||(e=new p(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{let o=this.prerelease[n],i=e.prerelease[n];if(C("prerelease compare",n,o,i),o===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(o===void 0)return-1;if(o===i)continue;return w(o,i)}while(++n)}compareBuild(e){e instanceof p||(e=new p(e,this.options));let n=0;do{let o=this.build[n],i=e.build[n];if(C("prerelease compare",n,o,i),o===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(o===void 0)return-1;if(o===i)continue;return w(o,i)}while(++n)}inc(e,n,o){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,o);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,o);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,o),this.inc("pre",n,o);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,o),this.inc("pre",n,o);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(o)?1:0;if(!n&&o===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let c=this.prerelease.length;for(;--c>=0;)typeof this.prerelease[c]=="number"&&(this.prerelease[c]++,c=-2);if(c===-1){if(n===this.prerelease.join(".")&&o===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let c=[n,i];o===!1&&(c=[n]),w(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=c):this.prerelease=c}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};fe.exports=p});var q=l((Tn,ge)=>{var Ee=G(),gt=(t,e,n=!1)=>{if(t instanceof Ee)return t;try{return new Ee(t,e)}catch(o){if(!n)return null;throw o}};ge.exports=gt});var we=l((On,ye)=>{var yt=q(),wt=(t,e)=>{let n=yt(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null};ye.exports=wt});var k=l((Cn,Ie)=>{var $e=G(),$t=(t,e,n)=>new $e(t,n).compare(new $e(e,n));Ie.exports=$t});var ve=l((Ln,xe)=>{var It=k(),xt=(t,e,n)=>It(t,e,n)>0;xe.exports=xt});var be=l((kn,Ae)=>{var vt=k(),At=(t,e,n)=>vt(t,e,n)<0;Ae.exports=At});var H=l((Dn,Re)=>{var bt=k(),Rt=(t,e,n)=>bt(t,e,n)<=0;Re.exports=Rt});var Se=l((Pn,Ne)=>{var Nt=q(),St=(t,e)=>{let n=Nt(t,e);return n?n.version:null};Ne.exports=St});var Ft={};He(Ft,{default:()=>Me});module.exports=Xe(Ft);var ee=E(require("os"),1);var W=t=>{try{let e=JSON.parse(t);if(e&&typeof e=="object")return!0}catch{}return!1};var Y=require("child_process"),Z=require("util");var B=require("@raycast/api");var g=require("@raycast/api"),P=class{toast;abortable;_abortController;constructor(e){this.abortable=e.abortable,this.toast=g.environment.launchType===g.LaunchType.UserInitiated?new g.Toast(e):void 0,this.updateAbortAction()}updateAbortAction(){this.toast&&(this._abortController=this.abortable?new AbortController:void 0,this.toast.primaryAction=this.abortable?{title:"Cancel",onAction:()=>{console.warn("Aborting..."),this._abortController?.abort()}}:void 0)}updateContent(e){if(this.toast){let{title:n,style:o,message:i,secondaryAction:c}=this.toast;this.toast.title=e.title??n,this.toast.style=e.style??o,this.toast.message=e.message??i,this.abortable=e.abortable??this.abortable,this.toast.secondaryAction=e.secondaryAction??c,this.updateAbortAction()}}show(){return this.toast?this.toast.show():Promise.resolve()}hide(){return this.toast?this.toast.hide():Promise.resolve()}get abortController(){return this._abortController}},N=async t=>{let e=new P(t);return await e.show(),e};var J=E(require("os"),1);var{username:_t}=J.default.userInfo();var Q=require("@raycast/api");var F=t=>t==null?"":String(t),S=t=>t instanceof Error?t.message:F(t);var Ve=require("@raycast/api");var y=(0,Z.promisify)(Y.exec),v=t=>typeof t=="object"&&"stderr"in t?t.stderr:S(t);var K=`${ee.default.homedir()}/.midway/cookie`,Be=t=>typeof t=="object"&&t.__type&&t.__type.includes("Exception"),Je=t=>typeof t=="object"&&t.status&&t.status==="error",Qe=(t,e)=>{let{cookie:n,data:o,args:i=[],headers:c={},method:I,maxBuffer:m,cancel:x}=e,b=[`curl -sSL '${t}'`,`-X ${I??"GET"}`,Object.entries(c).map(([u,D])=>`-H '${u}: ${D}'`),i,o?[`-d '${JSON.stringify(o)}'`]:[],n?[`-b '${Object.entries(n).map(([u,D])=>`${u}=${D}`).join(";")}'`]:[]].flat();return y(b.join(" "),{maxBuffer:m,signal:x?.signal}).then(({stdout:u})=>W(u)?JSON.parse(u):u).catch(u=>{throw new Error(v(u))})};var h=(t,e={})=>{let{ignoreCoralError:n=!1,writeToCookieFile:o=!0,args:i=[],...c}=e,I=[i,`--anyauth --location-trusted -k -u : -b ${K}`,o?[`-c ${K}`]:[]].flat();return Qe(t,{...c,args:I}).then(m=>{if(!n&&Be(m))throw new Error(`${m.__type}${m.message?`: ${m.message}`:""}`);if(Je(m))throw new Error(`${m.message??"Midway Error"}: ${m.desc??"You should authenticate (may use mwinit)"}`);return m})};var Ye=(t,e)=>h("https://gitfarm-sso.corp.amazon.com",{...e,method:"POST",headers:{"Content-Encoding":"amz-1.0","Content-Type":"application/json; charset=UTF-8","X-Amz-Target":`com.amazon.brazil.gitfarm.service.GitFarmService.${t}`}}),te=t=>Ye("getReferenceSha1s",{data:{repositoryId:t}}).then(e=>e.references);var T=require("@raycast/api");function O(t,e=!0){let{launchType:n,extensionName:o,commandName:i}=T.environment;return!e||n===T.LaunchType.Background?Promise.resolve():h("https://analytics.raycast.tools.aws.dev/v2/stats",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},data:{commandName:i,extensionVersion:t,extensionName:o}}).catch(c=>console.warn(`Failed to publish stats for ${o}/${i}.`,c))}var d=require("@raycast/api");var Tt=E(we(),1),X=E(ve(),1),Ot=E(be(),1),Ct=E(H(),1),Te=E(Se(),1);var Oe=t=>te(`pkg/${t}`).then(e=>e.map(n=>(n.name.match(/refs\/tags\/(.*)/)??["",""])[1]).filter(n=>(0,Te.default)(n))).then(e=>e.length===0?void 0:e.reduce((n,o)=>(0,X.default)(o,n)?o:n,e[0])).catch(e=>{console.warn(`Failed to get the latest extension version for ${t}.`,e)}),Ce=async t=>{let{launchType:e,extensionName:n}=d.environment,{updateCommandName:o,changelogCommandName:i,currentVersion:c,pkg:I,extensionOwner:m}=t,x=await Oe(I);if(e===d.LaunchType.UserInitiated&&x&&(0,X.default)(x,c)){let b={type:d.LaunchType.UserInitiated,extensionName:n,ownerOrAuthorName:m};await(0,d.showToast)({style:d.Toast.Style.Success,title:`\u2728 New version (${x}) now available!`,message:`Upgrade from current version (${c}) for the latest features and improvements.`,primaryAction:{title:"Update Extension",onAction:()=>(0,d.launchCommand)({name:o??"update-extension",...b})},secondaryAction:{title:"Changelog",onAction:()=>(0,d.launchCommand)({name:i??"extension-changelog",...b})}})}};var A=require("@raycast/api");var kt=E(H());var ke="1.17.9";var De="zhenpewu";var _=ke,Dt="AmznRaycastExtension";var Pe=()=>Ce({pkg:Dt,currentVersion:_,extensionOwner:De});var Pt=()=>O(_,!0),Fe=Pt;var $=require("@raycast/api");async function Me(t){let e=await N({style:$.Toast.Style.Animated,title:"Generating Tiny URL..."}),n=new URLSearchParams({name:t.arguments.url,opaque:"1"});try{let o=await h(`https://tiny.amazon.com/submit/url?${n}`,{headers:{Accept:"application/json"}});if(o.error)throw new Error(o.error);await $.Clipboard.copy(F(o.short_url)),e.updateContent({style:$.Toast.Style.Success,title:"\u{1F389} Copied generated Tiny URL to clipboard successfully."})}catch(o){e.updateContent({style:$.Toast.Style.Failure,title:"\u274C Failed to generate Tiny URL.",message:S(o)})}await Fe(),await Pe()}
